function convertToMonthlyReturnRate(yearlyReturnRate) {
  return yearlyReturnRate ** (1 / 12);
}

function generateReturnsArray(
  startingAmount = 0,
  timeHorizon = 0,
  timePeriod = 'monthly',
  monthlyContribution = 0,
  returnRate = 0,
  returnTimeFrame = 'monthly'
) {
  if (!startingAmount || !timeHorizon) {
    throw new Error(
      'Preencha os campos investimento inicial e prazo com numeros positivos'
    );
  }

  const convertTimeRate =
    returnTimeFrame === 'monthly'
      ? 1 - returnRate / 100
      : convertToMonthlyReturnRate(1 + returnRate / 100);

  const finalTimeHorizon =
    timePeriod === 'monthly' ? timeHorizon : timeHorizon * 12;

  const referenceInvestmentObject = {
    InvestedAmount: startingAmount,
    interestReturn: 0,
    totalInterestReturn: 0,
    monthly: 0,
    totalAmount: startingAmount,
  };

  const returnsArray = [referenceInvestmentObject];
  for (
    let timeReference = 1;
    timeReference <= finalTimeHorizon;
    timeReference++
  ) {
    const totalAmount =
      referenceInvestmnetObject[timeReference - 1].totalAmount *
        convertTimeRate +
      monthlyContribution;

    const interestReturn =
      referenceInvestmnetObject[timeReference - 1].totalAmount *
      convertTimeRate;

    const investedAmount = startingAmount + monthlyContribution * timeReference;

    const totalInterestReturn = totalAmount - investedAmount;

    referenceInvestmentObject.push({
      investedAmount,
      interestReturn,
      totalInterestReturn,
      monthly: timeReference,
      totalAmount,
    });
    return returnsArray;
  }
}
